# Wassertech CRM (Android)

**–í–µ—Ä—Å–∏—è:** Handover #9  
**–°—Ç–µ–∫:** Kotlin ¬∑ Jetpack Compose ¬∑ Material 3 ¬∑ Room ¬∑ ViewModel ¬∑ StateFlow

---

## üìò –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
–ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –∏–Ω–∂–µ–Ω–µ—Ä–æ–≤ Wassertech, –∑–∞–Ω–∏–º–∞—é—â–µ–µ—Å—è —É—á—ë—Ç–æ–º –∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ–º —Å–∏—Å—Ç–µ–º –≤–æ–¥–æ–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏.

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- –£—á—ë—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤ ‚Üí –æ–±—ä–µ–∫—Ç–æ–≤ (Sites) ‚Üí —É—Å—Ç–∞–Ω–æ–≤–æ–∫ (Installations) ‚Üí –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (Components)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞–º–∏ —á–µ–∫-–ª–∏—Å—Ç–æ–≤ –¢–û (Templates)
- –ü—Ä–æ–≤–µ–¥–µ–Ω–∏–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è (–¢–û) —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ –±–∞–∑—É Room
- –ò—Å—Ç–æ—Ä–∏—è –¢–û (–æ–±—â–∞—è –∏ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ)
- –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –¥–µ—Ä–µ–≤—É –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ –æ–±—ä–µ–∫—Ç–æ–≤ —Å –µ–¥–∏–Ω—ã–º UI-—Å—Ç–∏–ª–µ–º

---

## ‚öôÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

| –°–ª–æ–π | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-------------|-----------|
| UI | Jetpack Compose + Material 3 | –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å |
| –ù–∞–≤–∏–≥–∞—Ü–∏—è | `androidx.navigation.compose` | –û–¥–Ω–æ—Å—Ç–µ–∫–æ–≤–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è –º–µ–∂–¥—É —ç–∫—Ä–∞–Ω–∞–º–∏ |
| –î–∞–Ω–Ω—ã–µ | Room | –õ–æ–∫–∞–ª—å–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö, DAO –∏ –º–∏–≥—Ä–∞—Ü–∏–∏ |
| –õ–æ–≥–∏–∫–∞ | ViewModel + Coroutines + Flow | –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏, —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å |
| –°–æ—Å—Ç–æ—è–Ω–∏—è | StateFlow + collectAsState() | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI |

---

## üß≠ –ù–∞–≤–∏–≥–∞—Ü–∏—è

**–°—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω:** `clients`

| –ú–∞—Ä—à—Ä—É—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----------|
| `clients` | –°–ø–∏—Å–æ–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤ |
| `client/{clientId}` | –ö–∞—Ä—Ç–æ—á–∫–∞ –∫–ª–∏–µ–Ω—Ç–∞, —Å–ø–∏—Å–æ–∫ –æ–±—ä–µ–∫—Ç–æ–≤ |
| `site/{siteId}` | –û–±—ä–µ–∫—Ç –∫–ª–∏–µ–Ω—Ç–∞, —Å–ø–∏—Å–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–æ–∫ |
| `installation/{installationId}` | –£—Å—Ç–∞–Ω–æ–≤–∫–∞, —Å–ø–∏—Å–æ–∫ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ |
| `maintenance_all/{siteId}/{installationId}/{installationName}` | –ü—Ä–æ–≤–µ–¥–µ–Ω–∏–µ –¢–û —É—Å—Ç–∞–Ω–æ–≤–∫–∏ |
| `maintenance_history` | –û–±—â–∞—è –∏—Å—Ç–æ—Ä–∏—è –¢–û |
| `maintenance_history/{installationId}` | –ò—Å—Ç–æ—Ä–∏—è –¢–û –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ |
| `templates` | –°–ø–∏—Å–æ–∫ —à–∞–±–ª–æ–Ω–æ–≤ |
| `template_editor/{templateId}` | –†–µ–¥–∞–∫—Ç–æ—Ä —à–∞–±–ª–æ–Ω–∞ |

---

## üóÑ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö (Room)

### –û—Å–Ω–æ–≤–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏
- **ClientEntity** ‚Äî –∫–ª–∏–µ–Ω—Ç, –∫–æ–Ω—Ç–∞–∫—Ç—ã
- **SiteEntity** ‚Äî –æ–±—ä–µ–∫—Ç –∫–ª–∏–µ–Ω—Ç–∞
- **InstallationEntity** ‚Äî —É—Å—Ç–∞–Ω–æ–≤–∫–∞
- **ComponentEntity** ‚Äî –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏
- **ChecklistTemplateEntity** ‚Äî —à–∞–±–ª–æ–Ω —á–µ–∫-–ª–∏—Å—Ç–∞
- **MaintenanceSessionEntity** ‚Äî —Å–µ—Å—Å–∏—è –¢–û
- **MaintenanceValueEntity** ‚Äî –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–ª–µ–π –¢–û

### –¢–∏–ø—ã
- **FieldType:** `CHECKBOX`, `NUMBER`, `TEXT`
- **ComponentType:** –ª–æ–≥–∏—á–µ—Å–∫–∏–π —Ç–∏–ø –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞

### DAO
- `ClientDao` ‚Äî –≤—ã–±–æ—Ä–∫–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤
- `HierarchyDao` ‚Äî –¥–µ—Ä–µ–≤–æ –∫–ª–∏–µ–Ω—Ç–æ–≤, –æ–±—ä–µ–∫—Ç–æ–≤, —É—Å—Ç–∞–Ω–æ–≤–æ–∫, –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- `TemplatesDao` ‚Äî —à–∞–±–ª–æ–Ω—ã –∏ –ø–æ–ª—è —à–∞–±–ª–æ–Ω–æ–≤
- `SessionsDao` ‚Äî —Ä–∞–±–æ—Ç–∞ —Å –¢–û –∏ –∏—Å—Ç–æ—Ä–∏–µ–π

---

## üß© –ö–ª—é—á–µ–≤—ã–µ —ç–∫—Ä–∞–Ω—ã

| –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------|-------------|
| `ClientsRoute.kt` | –°–ø–∏—Å–æ–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤ |
| `ClientDetailScreen.kt` | –ö–∞—Ä—Ç–æ—á–∫–∞ –∫–ª–∏–µ–Ω—Ç–∞ |
| `SiteDetailScreen.kt` | –û–±—ä–µ–∫—Ç –∫–ª–∏–µ–Ω—Ç–∞ |
| `ComponentsScreen.kt` | –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã |
| `MaintenanceScreen.kt` | –ü—Ä–æ–≤–µ–¥–µ–Ω–∏–µ –¢–û |
| `MaintenanceHistoryScreen.kt` | –ò—Å—Ç–æ—Ä–∏—è –¢–û |
| `TemplatesScreen.kt` | –°–ø–∏—Å–æ–∫ —à–∞–±–ª–æ–Ω–æ–≤ |
| `TemplateEditorScreen.kt` | –†–µ–¥–∞–∫—Ç–æ—Ä —à–∞–±–ª–æ–Ω–æ–≤ |

---

## üß† ViewModel —Å–ª–æ–π

### HierarchyViewModel
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞–º–∏, –æ–±—ä–µ–∫—Ç–∞–º–∏, —É—Å—Ç–∞–Ω–æ–≤–∫–∞–º–∏, –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ, –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ
- –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –ø–æ `orderIndex`
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ—Ç–æ–∫–æ–≤ `Flow`

### MaintenanceViewModel
- –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —ç–∫—Ä–∞–Ω–æ–≤ –¢–û
- –ê–≥—Ä–µ–≥–∞—Ü–∏—è –ø–æ–ª–µ–π –ø–æ –≤—Å–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º —É—Å—Ç–∞–Ω–æ–≤–∫–∏
- –ò–º–º—É—Ç–∞–±–µ–ª—å–Ω—ã–µ –∞–ø–¥–µ–π—Ç–µ—Ä—ã –¥–ª—è Compose
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¢–û (`insertSessionWithValues`)

### TemplatesViewModel
- –ó–∞–≥—Ä—É–∑–∫–∞ –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–æ–≤
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–ª–∞–≥–æ–≤ `isForMaintenance`, `min/max/unit`

---

## üß± –ú–∏–≥—Ä–∞—Ü–∏–∏ Room

–ê–∫—Ç—É–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è: **3**

`Migration_2_3.kt`
- —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü `maintenance_sessions` –∏ `maintenance_values`
- –∏–Ω–¥–µ–∫—Å—ã `idx_mv_session`, `idx_mv_installation`, `idx_mv_component`

---

## üé® UI-–ø–∞—Ç—Ç–µ—Ä–Ω—ã

- –£–∑–∫–∞—è –ø–æ–ª–æ—Å–∫–∞ –ø–æ–¥ AppBar (`Surface(tonalElevation=1)`)
- –ü–ª–∞—à–∫–∏-–∑–∞–≥–æ–ª–æ–≤–∫–∏ –≤ —Å—Ç–∏–ª–µ secondaryContainer
- BottomBar —Å –∫–Ω–æ–ø–∫–æ–π ¬´–ò–∑–º–µ–Ω–∏—Ç—å¬ª
- –ï–¥–∏–Ω–∞—è —Å—Ç–∏–ª–∏—Å—Ç–∏–∫–∞ –∫–∞—Ä—Ç–æ—á–µ–∫ (–∫–ª–∏–µ–Ω—Ç—ã, –æ–±—ä–µ–∫—Ç—ã, —É—Å—Ç–∞–Ω–æ–≤–∫–∏)

---

## ‚úÖ –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:
- –ü–æ–ª–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞ ¬´–ö–ª–∏–µ–Ω—Ç—ã ‚Üí –û–±—ä–µ–∫—Ç—ã ‚Üí –£—Å—Ç–∞–Ω–æ–≤–∫–∏ ‚Üí –ü—Ä–æ–≤–µ–¥–µ–Ω–∏–µ –¢–û ‚Üí –ò—Å—Ç–æ—Ä–∏—è –¢–û¬ª
- –≠–∫—Ä–∞–Ω –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –¢–û –∞–≥—Ä–µ–≥–∏—Ä—É–µ—Ç –ø–æ–ª—è —Å–æ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
- –†–µ–∞–∫—Ç–∏–≤–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ Room
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –∏ —Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –ë–î
- –£–¥–∞–ª–µ–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, Snackbar –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –¢–û

---

## üöÄ –ë–ª–∏–∂–∞–π—à–∏–µ –∑–∞–¥–∞—á–∏

1. **–ù–∞–≤–∏–≥–∞—Ü–∏—è:** —É–±—Ä–∞—Ç—å `componentId` –∏–∑ `maintenance_all`
2. **–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:** —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å—Ç—Ä–µ–ª–∫–∏ ‚Üë‚Üì
3. **–†–µ–¥–∞–∫—Ç–æ—Ä —à–∞–±–ª–æ–Ω–æ–≤:** –ø–æ—Ä—è–¥–æ–∫ –ø–æ–ª–µ–π + —Ñ–ª–∞–≥–∏ `isForMaintenance`, `min/max/unit/required`
4. **–í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–∏ –¢–û:** –¥–∏–∞–ø–∞–∑–æ–Ω—ã, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è
5. **–ò—Å—Ç–æ—Ä–∏—è –¢–û:** —ç–∫—Ä–∞–Ω –¥–µ—Ç–∞–ª–µ–π —Å–µ—Å—Å–∏–∏

---

## üß≠ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Android Studio (–≤–µ—Ä—Å–∏—è 2024.1+)
2. –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ–µ–∫—Ç ‚Üí –¥–æ–∂–¥–∞—Ç—å—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ Gradle
3. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è JDK –∏–∑ Android Studio (Embedded)
4. –ó–∞–ø—É—Å—Ç–∏—Ç—å –Ω–∞ —ç–º—É–ª—è—Ç–æ—Ä–µ –∏–ª–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ (API 33+)

---

## üí° –ò–¥–µ–∏ –Ω–∞ –±—É–¥—É—â–µ–µ

- –ß–µ—Ä–Ω–æ–≤–∏–∫–∏ –¢–û (draft)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å–∏–≥–Ω–∞–ª—ã –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π (min/max)
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º (REST)
- PDF/Excel –æ—Ç—á—ë—Ç—ã
- –¢–µ–º–Ω–∞—è —Ç–µ–º–∞ –∏ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è

---

¬© Wassertech 2025
